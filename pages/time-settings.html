<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, viewport-fit=cover"
    />
    <title>Time Clock Settings — EarnRoute</title>
    <link rel="stylesheet" href="../style.css" />
    <script
      defer
      src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"
    ></script>
    <script defer src="../assets/js/script.js"></script>
    <script type="module" src="../assets/js/config.supabase.js"></script>
    <script type="module" src="../assets/js/auth.supabase.js"></script>
    <script type="module" src="../assets/js/db.supabase.js"></script>
    <script type="module" src="../assets/js/sync.supabase.js"></script>
    <script src="../assets/js/util.dom.js"></script>
    <script defer src="../assets/js/time-settings.js"></script>

    <!-- ✅ Authentication gate -->
    <script type="module">
      import { requireAuthOrRedirect } from "../assets/js/auth.supabase.js";
      requireAuthOrRedirect(); // kicks to login if not signed in
    </script>
  </head>
  <body>
    <!-- Fixed Header -->
    <header class="app-header">
      <button class="hamburger" aria-label="Menu">
        <span class="hamburger-bars"></span>
      </button>
      <div class="title">EarnRoute</div>
    </header>

    <!-- Scrollable Content (no Start/End action bar here) -->
    <main class="content no-actionbar">
      <section class="card">
        <h3>Time Clock Settings</h3>

        <!-- Duration preview pill -->
        <div
          class="pill gray"
          id="durationPreviewPill"
          style="margin-bottom: 16px"
        >
          Duration preview: Pending
        </div>

        <!-- Start Date/Time -->
        <div class="row" style="margin-top: 12px">
          <div><strong>Start date &amp; time</strong></div>
          <div style="width: 100%; max-width: 260px">
            <input
              id="timeStartInput"
              type="datetime-local"
              step="1"
              style="width: 100%"
            />
          </div>
        </div>

        <!-- End Date/Time -->
        <div class="row" style="margin-top: 12px">
          <div><strong>End date &amp; time</strong></div>
          <div style="width: 100%; max-width: 260px">
            <input
              id="timeEndInput"
              type="datetime-local"
              step="1"
              style="width: 100%"
            />
          </div>
        </div>

        <p style="font-size: 0.9rem; color: #6b7280; margin-top: 10px">
          These values control the <strong>Start Time</strong>,
          <strong>End Time</strong>, and <strong>Duration</strong> pill on the
          Home screen.
        </p>

        <div
          class="actions"
          style="
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 16px;
          "
        >
          <button id="reloadTimeBtn" class="btn-secondary">Reload</button>
          <button id="saveTimeBtn" class="btn-primary">Save</button>
        </div>

        <div
          id="timeErrorBox"
          style="
            display: none;
            margin-top: 8px;
            color: #b91c1c;
            font-size: 0.9rem;
          "
        ></div>
        <div
          id="timeSuccessBox"
          style="
            display: none;
            margin-top: 8px;
            color: #0a7d31;
            font-size: 0.95rem;
          "
        ></div>
      </section>
    </main>

    <!-- Fixed Bottom Navigation (same pattern) -->
    <nav class="bottom-nav">
      <div class="nav-inner">
        <a class="nav-item" href="home.html">
          <i data-lucide="home"></i><span>Home</span>
        </a>
        <a class="nav-item" href="deliveries.html">
          <i data-lucide="utensils"></i><span>Deliveries</span>
        </a>
        <a class="nav-item" href="earnings.html">
          <i data-lucide="dollar-sign"></i><span>Earnings</span>
        </a>
        <a class="nav-item" href="more.html">
          <i data-lucide="more-horizontal"></i><span>More</span>
        </a>
      </div>
    </nav>

    <div id="customToast"></div>

    <!-- Left slide-in drawer -->
    <aside id="sideDrawer" class="drawer">
      <div class="drawer-header">
        <h3>George Moreno</h3>
        <button id="closeDrawerBtn" class="drawer-close" aria-label="Close">
          ×
        </button>
      </div>

      <div class="drawer-content">
        <!-- Put any links you like here -->
        <a href="home.html" class="drawer-link">Home</a>
        <a href="deliveries.html" class="drawer-link">Deliveries</a>
        <a href="earnings.html" class="drawer-link">Earnings</a>
        <a href="more.html" class="drawer-link">More</a>
        <a href="time-settings.html" class="drawer-link">Time Clock Settings</a>

        <hr class="drawer-sep" />

        <button id="logoutBtn" class="drawer-logout">Logout</button>
        <p style="text-align: center">Version: 3.0.0</p>
      </div>
    </aside>

    <!-- Shared backdrop for drawer -->
    <div id="modalBackdrop" class="backdrop"></div>
  </body>
</html>
